DECLARE
@GEO1 GEOGRAPHY,
@LAT VARCHAR(10),
@LONG VARCHAR(10)

SET @LAT='3.062143'
SET @LONG='101.593854'

SET @geo1= geography::Point(@LAT, @LONG, 4326)

SELECT PI_ID,PI_PARTICIPANTID,LEFT(CONVERT(VARCHAR,
(@geo1.STDistance(geography::Point(ISNULL(PI_LATITUDE,0), 
ISNULL(PI_LONGITUDE,0), 4326))/1000)),5)+' Km' as DISTANCE FROM TPLZ_POI
WHERE (@geo1.STDistance(geography::Point(ISNULL(PI_LATITUDE,0), 
ISNULL(PI_LONGITUDE,0), 4326)))/1000 < 7


SELECT PI_ID,PI_PARTICIPANTID,LEFT(CONVERT(VARCHAR,
(geography::Point(3.062143, 101.593854, 4326).STDistance(geography::Point(ISNULL(PI_LATITUDE,0), 
ISNULL(PI_LONGITUDE,0), 4326))/1000)),5)+' Km' as DISTANCE FROM TPLZ_POI
WHERE (geography::Point(3.062143, 101.593854, 4326).STDistance(geography::Point(ISNULL(PI_LATITUDE,0), 
ISNULL(PI_LONGITUDE,0), 4326)))/1000 < 7

SELECT * FROM TPLZ_POI WHERE
    (PI_LATITUDE >= 3.061000 AND PI_LATITUDE <= 5.406589) AND (PI_LONGITUDE >= 103.300000 AND PI_LONGITUDE <= 116.217944)
AND
    acos(sin(1.3963) * sin(PI_LATITUDE) + cos(1.3963) * cos(PI_LATITUDE) * cos(PI_LONGITUDE - (-0.6981))) <= 0.1570;